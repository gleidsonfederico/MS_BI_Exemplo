
WITH
SET [CLIENTES] AS
'ORDER([Cliente].[Hierarquia Geográfica].[Nível Cliente], [Measures].[Faturamento], BDESC)'
MEMBER [Measures].[Posição no Rank] as
'RANK([Cliente].[Hierarquia Geográfica].Currentmember, [CLIENTES])', FORMAT_STRING = "#;#;-"
MEMBER [Measures].[Faturamento de Vendas] as
'[Measures].[Faturamento]', FORMAT_STRING = "##,###.00"
MEMBER [Measures].[% Vendas] as
'[Measures].[Faturamento]/([Measures].[Faturamento], [Cliente].[Hierarquia Geográfica].[All])', FORMAT_STRING = "#,###.00 %"
MEMBER [Measures].[Faturamento Acumulado] AS
'SUM(HEAD([CLIENTES],[Measures].[Posição no Rank]),[Measures].[Faturamento])',FORMAT_STRING = "#,###.00"
MEMBER [Measures].[Total de Clientes] as
'[CLIENTES].Count', FORMAT_STRING = "#;#;-"
MEMBER [Measures].[% Número Clientes] as
'[Measures].[Posição no Rank] / [Measures].[Total de Clientes]', FORMAT_STRING = "#,###.00 %"
MEMBER [Measures].[% Vendas Acumuladas] AS
'SUM(HEAD([CLIENTES],[Measures].[Posição no Rank]),[Measures].[% Vendas] )',FORMAT_STRING = "#,###.00 %"
SELECT ({ [CLIENTES] }) On Rows,
({[Measures].[Faturamento de Vendas]
, [Measures].[% Vendas Acumuladas]
, [Measures].[% Número Clientes]}) on Columns
from [COMPLETO]
Where ([Tempo].[Ano].&[2014])